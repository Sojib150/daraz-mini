<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Econsave TPG1 Work Tracker</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #2b7a0b;
      color: white;
      text-align: center;
      padding: 15px 0;
      font-size: 20px;
      font-weight: bold;
    }
    .container {
      max-width: 700px;
      margin: 20px auto;
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .worker {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #eee;
      padding: 10px 0;
    }
    .worker:last-child {
      border-bottom: none;
    }
    select {
      padding: 5px 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 14px;
    }
    .status {
      font-weight: bold;
      color: #2b7a0b;
    }
  </style>
</head>
<body>
  <header>Econsave TPG1 Work Tracker</header>
  <div class="container" id="workerList"></div>

  <!-- Firebase -->
  <script type="module">
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyB6b93A_HeU4FADs3o2Ysw6-dlRRS2TbZk",
      authDomain: "telegram-miniapp-e8cc0.firebaseapp.com",
      projectId: "telegram-miniapp-e8cc0",
      storageBucket: "telegram-miniapp-e8cc0.firebasestorage.app",
      messagingSenderId: "827930913054",
      appId: "1:827930913054:web:502b56e0c198d8e9ff410f",
      databaseURL: "https://telegram-miniapp-e8cc0-default-rtdb.asia-southeast1.firebasedatabase.app/"
    };

    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
    import { getDatabase, ref, set, get, onValue } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-database.js";

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // Worker names
    const workers = [
      "MOHAMMAD MASUD",
      "RAFIUL ISLAM",
      "ALAMIN",
      "MIAH SOHAG",
      "SHARIFUL ISLAM",
      "SOJEEB MIAH",
      "DELUAR",
      "SAJIB",
      "MIAH RUBEL",
      "MATANG DAH",
      "RANA SOHAL",
      "BAINATH YADAV",
      "KAMESHWER",
      "RANJIT KUMAR",
      "SANJAY KUMAR",
      "RAI AASH BAHADUR",
      "SAHAN UPENDRA",
      "SAH TELI SHANKAR PRASAD",
      "RAY TEJNAYAN",
      "AHAMMED MD SAMIM",
      "MOHAMMED ASHRAFUL",
      "SHEKH MD SAKIB",
      "ISLAM MD AHANARUL",
      "BIJAYA TAMANG",
      "THAKUR JAY PRAKASH",
      "BOHARA LAXMAN",
      "BHANDARI LIL MAN",
      "BISHWAKARMA BHUPAT RAJ",
      "BISHOKARMA NOM BAHADUR",
      "BOHARA PREM",
      "YADAV DINESH KUMAR",
      "BK RAJ KUMAR"
    ];

    const workOptions = [
      "Unloading goods from container",
      "Arranging goods by barcode",
      "Receiving goods",
      "Picking goods",
      "QC checking",
      "Driving forklift",
      "MC (Medical leave / sick)",
      "Store cleaning",
      "No work"
    ];

    const workerList = document.getElementById("workerList");

    // Display workers
    workers.forEach(name => {
      const div = document.createElement("div");
      div.className = "worker";
      div.innerHTML = `
        <span>${name}</span>
        <select id="${name.replace(/\s+/g, '_')}">
          ${workOptions.map(w => `<option value="${w}">${w}</option>`).join('')}
        </select>
      `;
      workerList.appendChild(div);

      // Listen for changes
      const select = div.querySelector("select");
      const workRef = ref(db, "workers/" + name);

      onValue(workRef, (snapshot) => {
        if (snapshot.exists()) {
          select.value = snapshot.val();
        }
      });

      select.addEventListener("change", () => {
        set(workRef, select.value);
      });
    });
  </script>
</body>
</html>
